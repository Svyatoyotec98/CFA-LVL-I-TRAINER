# CLAUDE_CODE_MANUAL.md
# CFA Level 1 Trainer ‚Äî –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 11 —è–Ω–≤–∞—Ä—è 2026  
**–≠–∫–∑–∞–º–µ–Ω:** 13 –º–∞—è 2026 (~4 –º–µ—Å—è—Ü–∞)  
**–ê–≤—Ç–æ—Ä —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** Claude Code  

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#1-–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#2-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#3-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#4-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
5. [API Endpoints](#5-api-endpoints)
6. [Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#6-frontend-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
7. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å](#7-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
8. [–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä-—Ç—Ä–µ–Ω–∞–∂—ë—Ä BA II Plus](#8-–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä-—Ç—Ä–µ–Ω–∞–∂—ë—Ä-ba-ii-plus)
9. [–ü–∞—Ä—Å–∏–Ω–≥ PDF](#9-–ø–∞—Ä—Å–∏–Ω–≥-pdf)
10. [–≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏](#10-—ç—Ç–∞–ø—ã-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
11. [–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

---

## 1. –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### 1.1 –¶–µ–ª—å
–í–µ–±-—Ç—Ä–µ–Ω–∞–∂—ë—Ä –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —ç–∫–∑–∞–º–µ–Ω—É CFA Level 1, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ Spanish Trainer.

### 1.2 –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **10 –∫–Ω–∏–≥ (Books)** —Å –∫–æ–Ω—Å–ø–µ–∫—Ç–∞–º–∏ –∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏ –æ—Ç AnalystPrep
- **~3500 –≤–æ–ø—Ä–æ—Å–æ–≤** —Ñ–æ—Ä–º–∞—Ç–∞ Multiple Choice (A/B/C)
- **–ú–∞–Ω—É–∞–ª BA II Plus Professional** ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≥–∞–π–¥ Texas Instruments

### 1.3 –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
1. **Mappe —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Spanish ‚Üí CFA:**
   - Unidad ‚Üí Book
   - Categor√≠a ‚Üí Learning Module (–≥–ª–∞–≤–∞)
   - Palabra ‚Üí Question

2. **–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ 80%** ‚Äî —Å–ª–µ–¥—É—é—â–∞—è –≥–ª–∞–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ 80%+ –≤ —Ç–µ–∫—É—â–µ–π

3. **–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ç–µ—Å—Ç–æ–≤:**
   - Standard Mode ‚Äî –æ–±—â–µ–µ –≤—Ä–µ–º—è, —Å–≤–æ–±–æ–¥–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
   - 90-Second Mode ‚Äî 90 —Å–µ–∫—É–Ω–¥ –Ω–∞ –≤–æ–ø—Ä–æ—Å, —É—Ö–æ–¥ –≤ –º–∏–Ω—É—Å

---

## 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### 2.1 Backend
```
Framework:     FastAPI
ORM:           SQLAlchemy
Database:      SQLite (—Ñ–∞–π–ª cfa_trainer.db)
Auth:          JWT —Ç–æ–∫–µ–Ω—ã (python-jose)
Password:      bcrypt —á–µ—Ä–µ–∑ passlib
```

### 2.2 Frontend
```
HTML/CSS/JS:   Vanilla (–±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤)
–°—Ç–∏–ª—å:         Glassmorphism UI
–§–æ—Ä–º—É–ª—ã:       MathJax (CDN)
–•—Ä–∞–Ω–µ–Ω–∏–µ:      localStorage + sync —Å backend
```

### 2.3 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
cfa-trainer/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI app
‚îÇ   ‚îú‚îÄ‚îÄ models.py            # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py           # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ auth.py              # JWT –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ database.py          # DB connection
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îú‚îÄ‚îÄ users.py
‚îÇ       ‚îú‚îÄ‚îÄ progress.py
‚îÇ       ‚îú‚îÄ‚îÄ tests.py
‚îÇ       ‚îî‚îÄ‚îÄ calculator.py
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ index.html           # –ï–¥–∏–Ω—ã–π HTML (SPA-like)
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ styles.css
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.js           # –í—Å—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ data/
‚îÇ       ‚îú‚îÄ‚îÄ books/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ book1_quantitative.json
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ book2_economics.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ       ‚îî‚îÄ‚îÄ glossary/
‚îÇ           ‚îú‚îÄ‚îÄ book1_terms.json
‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ parse_pdf.py         # –ü–∞—Ä—Å–∏–Ω–≥ PDF ‚Üí JSON
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### 3.1 –§–æ—Ä–º–∞—Ç JSON –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤

**–§–∞–π–ª:** `frontend/data/books/book1_quantitative.json`

```json
{
  "book_id": 1,
  "book_name": "Quantitative Methods",
  "book_name_ru": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã",
  "total_questions": 350,
  "learning_modules": [
    {
      "module_id": 1,
      "module_name": "Rates and Returns",
      "module_name_ru": "–°—Ç–∞–≤–∫–∏ –∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏",
      "questions": [
        {
          "question_id": "QM-1-001",
          "question_text": "An investor purchases a stock for $50 and sells it one year later for $55, receiving a $2 dividend. The holding period return is closest to:",
          "question_text_formula": null,
          "has_table": false,
          "has_image": false,
          "image_path": null,
          "options": {
            "A": "10.0%",
            "B": "12.0%",
            "C": "14.0%"
          },
          "correct_answer": "C",
          "explanation": "HPR = (Ending Price - Beginning Price + Dividend) / Beginning Price = ($55 - $50 + $2) / $50 = 14%",
          "explanation_wrong": {
            "A": "This answer ignores the dividend payment",
            "B": "This answer uses incorrect formula for capital gain"
          },
          "calculator_steps": null,
          "difficulty": "easy",
          "los_reference": "LOS 1.a"
        },
        {
          "question_id": "QM-1-002",
          "question_text": "Calculate the future value of $10,000 invested for 5 years at 8% annual interest, compounded quarterly.",
          "question_text_formula": "$FV = PV \\times (1 + \\frac{r}{m})^{m \\times n}$",
          "has_table": false,
          "has_image": false,
          "image_path": null,
          "options": {
            "A": "$14,693.28",
            "B": "$14,802.44",
            "C": "$14,859.47"
          },
          "correct_answer": "B",
          "explanation": "FV = $10,000 √ó (1 + 0.08/4)^(4√ó5) = $10,000 √ó (1.02)^20 = $14,859.47",
          "explanation_wrong": {
            "A": "Uses simple interest instead of compound",
            "C": "Uses monthly compounding instead of quarterly"
          },
          "calculator_steps": [
            "2ND [CLR TVM]",
            "10000 [+/-] [PV]",
            "8 [I/Y]",
            "5 [2ND] [xP/Y] [N]",
            "4 [2ND] [P/Y] [ENTER]",
            "[CPT] [FV]"
          ],
          "difficulty": "medium",
          "los_reference": "LOS 1.b"
        }
      ]
    }
  ]
}
```

### 3.2 –§–æ—Ä–º–∞—Ç JSON –¥–ª—è –≥–ª–æ—Å—Å–∞—Ä–∏—è

**–§–∞–π–ª:** `frontend/data/glossary/book1_terms.json`

```json
{
  "book_id": 1,
  "book_name": "Quantitative Methods",
  "book_name_ru": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã",
  "total_terms": 21,
  "terms": [
    {
      "term_id": "T-QM-001",
      "term_en": "Holding Period Return (HPR)",
      "term_ru": "–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è",
      "definition_en": "The return earned from holding an asset for a single specified period of time. It is calculated as the sum of price change and income received (such as dividends), divided by the beginning price.",
      "definition_ru": "–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –æ—Ç –≤–ª–∞–¥–µ–Ω–∏—è –∞–∫—Ç–∏–≤–æ–º –∑–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—É–º–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã –∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–≤–∏–¥–µ–Ω–¥–æ–≤), –¥–µ–ª—ë–Ω–Ω–∞—è –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—É—é —Ü–µ–Ω—É.",
      "formula": "$HPR = \\frac{P_1 - P_0 + D_1}{P_0}$",
      "module_id": 1,
      "los_id": "LOS_1b",
      "related_terms": ["T-QM-002", "T-QM-003", "T-QM-008"],
      "calculator_steps": {
        "worksheet": "Direct Calculation",
        "access": "Standard keys",
        "steps": [
          "(P1 [-] P0) [=] ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã",
          "[+] D1 [=] ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥",
          "[√∑] P0 [=] ‚Äî —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—É—é —Ü–µ–Ω—É"
        ],
        "example": {
          "given": "P0=$100, P1=$110, D1=$5",
          "input": "(110 - 100 + 5) √∑ 100",
          "result": "HPR = 15%"
        }
      }
    },
    {
      "term_id": "T-QM-004",
      "term_en": "Harmonic Mean",
      "term_ru": "–°—Ä–µ–¥–Ω–µ–µ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ",
      "definition_en": "A measure of central tendency calculated as the number of observations divided by the sum of reciprocals of the observations.",
      "definition_ru": "–ú–µ—Ä–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º–∞—è –∫–∞–∫ —á–∏—Å–ª–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, –¥–µ–ª—ë–Ω–Ω–æ–µ –Ω–∞ —Å—É–º–º—É –æ–±—Ä–∞—Ç–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω.",
      "formula": "$\\bar{X}_H = \\frac{n}{\\sum_{i=1}^{n} \\frac{1}{X_i}}$",
      "module_id": 1,
      "los_id": "LOS_1b",
      "related_terms": ["T-QM-002", "T-QM-003"],
      "calculator_steps": {
        "worksheet": "Direct Calculation",
        "access": "Standard keys",
        "steps": [
          "1 [√∑] X1 [=] [+] ‚Äî –æ–±—Ä–∞—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è",
          "1 [√∑] X2 [=] [+] ‚Äî –æ–±—Ä–∞—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –≤—Ç–æ—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è",
          "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö Xi",
          "[=] ‚Äî —Å—É–º–º–∞ –æ–±—Ä–∞—Ç–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω",
          "n [√∑] (—Ä–µ–∑—É–ª—å—Ç–∞—Ç) [=] ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ"
        ],
        "example": {
          "given": "P/E ratios: 10, 15, 20",
          "input": "n=3, sum(1/Xi) = 1/10 + 1/15 + 1/20 = 0.2167",
          "result": "Harmonic Mean = 13.85"
        }
      }
    }
  ]
}
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π —Ç–µ—Ä–º–∏–Ω–∞:

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-------------|----------|
| `term_id` | string | ‚úÖ | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç–µ—Ä–º–∏–Ω–∞ (—Ñ–æ—Ä–º–∞—Ç: "T-QM-001") |
| `term_en` | string | ‚úÖ | –¢–µ—Ä–º–∏–Ω –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `term_ru` | string | ‚úÖ | –¢–µ—Ä–º–∏–Ω –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `definition_en` | string | ‚úÖ | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| `definition_ru` | string | ‚úÖ | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º |
| `formula` | string/null | ‚ùå | LaTeX —Ñ–æ—Ä–º—É–ª–∞ (—Å $ –æ–±—ë—Ä—Ç–∫–∞–º–∏) –∏–ª–∏ null |
| `module_id` | integer | ‚úÖ | ID –º–æ–¥—É–ª—è (1, 2, 3...) |
| `los_id` | string | ‚úÖ | LOS reference (—Ñ–æ—Ä–º–∞—Ç: "LOS_1a", "LOS_2b") |
| `related_terms` | array | ‚úÖ | –ú–∞—Å—Å–∏–≤ ID —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤ |
| `calculator_steps` | object/null | ‚ùå | –®–∞–≥–∏ —Ä–∞—Å—á—ë—Ç–∞ –Ω–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ –∏–ª–∏ null |

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ calculator_steps:

```json
{
  "worksheet": "Direct Calculation",  // –∏–ª–∏ "TVM", "Cash Flow", "Statistics", "Interest Conversion"
  "access": "Standard keys",          // –∏–ª–∏ "[2ND] [DATA]", "[CF]", "[2ND] [ICONV]"
  "steps": [                          // –ú–∞—Å—Å–∏–≤ —à–∞–≥–æ–≤ –¥–ª—è BA II Plus
    "–®–∞–≥ 1: –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è",
    "–®–∞–≥ 2: –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è",
    "..."
  ],
  "example": {
    "given": "–î–∞–Ω–æ: –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    "input": "–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞ –Ω–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ",
    "result": "–†–µ–∑—É–ª—å—Ç–∞—Ç = –∑–Ω–∞—á–µ–Ω–∏–µ"
  }
}
```

#### –ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ UI:

1. **–¢–µ—Ä–º–∏–Ω –≤—Å–µ–≥–¥–∞ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É: –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —Ç–µ—Ä–º–∏–Ω, —Ä—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Ñ–æ—Ä–º—É–ª–∞
2. **–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫ —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π** ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å `calculator_steps`, –±–ª–æ–∫ "BA II Plus: [Worksheet]" –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –ø–æ –∫–ª–∏–∫—É
3. **–§–∏–ª—å—Ç—Ä—ã:** –ø–æ Book ID –∏ Module ID —á–µ—Ä–µ–∑ dropdown
4. **Badges:** LOS badge (—Å–∏–Ω–∏–π) –∏ Module badge (—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π) —Å–ø—Ä–∞–≤–∞ –æ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞
5. **–§–æ—Ä–º—É–ª—ã:** —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ MathJax —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π LaTeX

### 3.3 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–Ω–∏–≥ CFA Level 1

| Book # | Name | ~Questions |
|--------|------|------------|
| 1 | Quantitative Methods | 350 |
| 2 | Economics | 350 |
| 3 | Financial Statement Analysis | 400 |
| 4 | Corporate Issuers | 250 |
| 5 | Equity Investments | 350 |
| 6 | Fixed Income | 400 |
| 7 | Derivatives | 300 |
| 8 | Alternative Investments | 200 |
| 9 | Portfolio Management | 350 |
| 10 | Ethics | 350 |
| **Total** | | **~3500** |

---

## 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 4.1 ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ (SQLAlchemy –º–æ–¥–µ–ª–∏)

```python
# models.py

from sqlalchemy import Column, Integer, String, Float, Boolean, DateTime, ForeignKey, JSON
from sqlalchemy.orm import relationship
from database import Base
import datetime

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    username = Column(String, unique=True, index=True)
    email = Column(String, unique=True, index=True)
    hashed_password = Column(String)
    created_at = Column(DateTime, default=datetime.datetime.utcnow)
    
    progress = relationship("UserProgress", back_populates="user")
    test_results = relationship("TestResult", back_populates="user")
    errors = relationship("UserError", back_populates="user")


class UserProgress(Base):
    __tablename__ = "user_progress"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    book_id = Column(Integer)
    module_id = Column(Integer)
    
    questions_seen = Column(Integer, default=0)
    questions_correct = Column(Integer, default=0)
    mastery_percent = Column(Float, default=0.0)
    is_unlocked = Column(Boolean, default=False)
    completed_at = Column(DateTime, nullable=True)
    
    user = relationship("User", back_populates="progress")


class TestResult(Base):
    __tablename__ = "test_results"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    
    test_type = Column(String)  # "module", "book", "mock_exam"
    test_mode = Column(String)  # "standard", "90_second"
    book_id = Column(Integer, nullable=True)
    module_id = Column(Integer, nullable=True)
    
    total_questions = Column(Integer)
    correct_answers = Column(Integer)
    score_percent = Column(Float)
    time_spent_seconds = Column(Integer)
    
    question_details = Column(JSON)  # [{question_id, user_answer, correct, time_spent}]
    created_at = Column(DateTime, default=datetime.datetime.utcnow)
    
    user = relationship("User", back_populates="test_results")


class UserError(Base):
    __tablename__ = "user_errors"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    question_id = Column(String)
    book_id = Column(Integer)
    module_id = Column(Integer)
    
    error_count = Column(Integer, default=1)
    last_error_at = Column(DateTime, default=datetime.datetime.utcnow)
    last_correct_at = Column(DateTime, nullable=True)
    
    # –î–ª—è Spaced Repetition
    next_review_at = Column(DateTime, nullable=True)
    review_interval_days = Column(Integer, default=1)
    
    user = relationship("User", back_populates="errors")


class CalculatorSession(Base):
    __tablename__ = "calculator_sessions"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"))
    
    worksheet_type = Column(String)  # "TVM", "CF", "Bond", "Stats"
    problem_data = Column(JSON)
    user_steps = Column(JSON)
    is_correct = Column(Boolean)
    time_spent_seconds = Column(Integer)
    created_at = Column(DateTime, default=datetime.datetime.utcnow)
```

---

## 5. API Endpoints

### 5.1 –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| POST | `/api/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è |
| POST | `/api/auth/login` | –í—Ö–æ–¥, –≤–æ–∑–≤—Ä–∞—Ç JWT |
| POST | `/api/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ |
| GET | `/api/auth/me` | –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |

### 5.2 –ü—Ä–æ–≥—Ä–µ—Å—Å

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/progress` | –í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| GET | `/api/progress/book/{book_id}` | –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–Ω–∏–≥–µ |
| POST | `/api/progress/sync` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å localStorage |

### 5.3 –¢–µ—Å—Ç—ã

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/tests/module/{book_id}/{module_id}` | –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–∞ –º–æ–¥—É–ª—è |
| GET | `/api/tests/book/{book_id}` | –¢–µ—Å—Ç –ø–æ –∫–Ω–∏–≥–µ (—Ä–∞–Ω–¥–æ–º) |
| GET | `/api/tests/mock-exam` | Mock Exam (180 –≤–æ–ø—Ä–æ—Å–æ–≤) |
| POST | `/api/tests/submit` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ |
| GET | `/api/tests/history` | –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤ |

### 5.4 –û—à–∏–±–∫–∏ –∏ Spaced Repetition

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/errors` | –í—Å–µ –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| GET | `/api/errors/review` | –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è |
| POST | `/api/errors/mark-reviewed` | –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø–æ–≤—Ç–æ—Ä—ë–Ω–Ω—ã–π |

### 5.5 –ì–ª–æ—Å—Å–∞—Ä–∏–π

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/glossary` | –í—Å–µ —Ç–µ—Ä–º–∏–Ω—ã |
| GET | `/api/glossary/book/{book_id}` | –¢–µ—Ä–º–∏–Ω—ã –ø–æ –∫–Ω–∏–≥–µ |
| GET | `/api/glossary/search?q=` | –ü–æ–∏—Å–∫ —Ç–µ—Ä–º–∏–Ω–æ–≤ |

### 5.6 –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä

| Method | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| GET | `/api/calculator/problems/{type}` | –ó–∞–¥–∞—á–∏ –ø–æ —Ç–∏–ø—É (TVM, CF, Bond) |
| POST | `/api/calculator/check` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ |
| GET | `/api/calculator/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—É |

---

## 6. Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 6.1 –ù–∞–≤–∏–≥–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–æ–≤ (SPA-like)

```javascript
// app.js - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

const screens = {
    'landing': document.getElementById('landing-screen'),
    'login': document.getElementById('login-screen'),
    'register': document.getElementById('register-screen'),
    'dashboard': document.getElementById('dashboard-screen'),
    'books': document.getElementById('books-screen'),
    'modules': document.getElementById('modules-screen'),
    'test': document.getElementById('test-screen'),
    'results': document.getElementById('results-screen'),
    'calculator': document.getElementById('calculator-screen'),
    'glossary': document.getElementById('glossary-screen'),
    'mock-exam': document.getElementById('mock-exam-screen'),
    'statistics': document.getElementById('statistics-screen')
};

function hideAllScreens() {
    Object.values(screens).forEach(screen => {
        screen.classList.add('hidden');
    });
}

function showScreen(screenName) {
    hideAllScreens();
    screens[screenName].classList.remove('hidden');
    window.scrollTo(0, 0);
}
```

### 6.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ index.html

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFA Level 1 Trainer</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- MathJax –¥–ª—è —Ñ–æ—Ä–º—É–ª -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async 
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>
<body>
    <!-- Landing Screen -->
    <div id="landing-screen" class="screen">
        <div class="glass-container">
            <h1>CFA Level 1 Trainer</h1>
            <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω—É 13 –º–∞—è 2026</p>
            <button onclick="showScreen('login')">–í–æ–π—Ç–∏</button>
            <button onclick="showScreen('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen hidden">
        <!-- —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
    </div>

    <!-- Dashboard Screen -->
    <div id="dashboard-screen" class="screen hidden">
        <nav class="top-nav">
            <span id="user-name"></span>
            <button onclick="logout()">–í—ã—Ö–æ–¥</button>
        </nav>
        
        <div class="dashboard-grid">
            <div class="card" onclick="showScreen('books')">
                <h3>üìö –ö–Ω–∏–≥–∏</h3>
                <p>10 –∫–Ω–∏–≥, ~3500 –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                <div class="progress-bar">
                    <div id="overall-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="card" onclick="showScreen('mock-exam')">
                <h3>üìù Mock Exam</h3>
                <p>–°–∏–º—É–ª—è—Ü–∏—è —ç–∫–∑–∞–º–µ–Ω–∞</p>
            </div>
            
            <div class="card" onclick="showScreen('calculator')">
                <h3>üî¢ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h3>
                <p>BA II Plus —Ç—Ä–µ–Ω–∞–∂—ë—Ä</p>
            </div>
            
            <div class="card" onclick="showScreen('glossary')">
                <h3>üìñ –ì–ª–æ—Å—Å–∞—Ä–∏–π</h3>
                <p>–¢–µ—Ä–º–∏–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</p>
            </div>
            
            <div class="card" onclick="showScreen('statistics')">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <p>–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫</p>
            </div>
        </div>
    </div>

    <!-- Books Screen -->
    <div id="books-screen" class="screen hidden">
        <nav class="breadcrumb">
            <a onclick="showScreen('dashboard')">Dashboard</a> / –ö–Ω–∏–≥–∏
        </nav>
        <div id="books-list" class="books-grid">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
    </div>

    <!-- Modules Screen -->
    <div id="modules-screen" class="screen hidden">
        <nav class="breadcrumb">
            <a onclick="showScreen('dashboard')">Dashboard</a> / 
            <a onclick="showScreen('books')">–ö–Ω–∏–≥–∏</a> / 
            <span id="current-book-name"></span>
        </nav>
        <div id="modules-list" class="modules-grid">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
    </div>

    <!-- Test Screen -->
    <div id="test-screen" class="screen hidden">
        <!-- –†–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div class="test-header">
            <div id="test-timer"></div>
            <div id="test-progress">1/20</div>
            <button onclick="flagQuestion()">üö© –û—Ç–º–µ—Ç–∏—Ç—å</button>
        </div>
        
        <div id="question-container" class="glass-container">
            <div id="question-text"></div>
            <div id="question-formula"></div>
            <div id="question-image"></div>
            
            <div id="options-container">
                <!-- A, B, C –≤–∞—Ä–∏–∞–Ω—Ç—ã -->
            </div>
        </div>
        
        <div class="test-navigation">
            <button onclick="prevQuestion()">‚Üê –ù–∞–∑–∞–¥</button>
            <button onclick="nextQuestion()">–î–∞–ª–µ–µ ‚Üí</button>
            <button onclick="submitTest()" id="submit-btn" class="hidden">
                –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç
            </button>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="screen hidden">
        <div class="glass-container">
            <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
            <div id="score-display"></div>
            <div id="time-display"></div>
            <div id="questions-review">
                <!-- –†–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ -->
            </div>
        </div>
    </div>

    <!-- Calculator Screen -->
    <div id="calculator-screen" class="screen hidden">
        <!-- BA II Plus —Ç—Ä–µ–Ω–∞–∂—ë—Ä -->
    </div>

    <!-- Mock Exam Screen -->
    <div id="mock-exam-screen" class="screen hidden">
        <!-- –ü–æ–ª–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è —ç–∫–∑–∞–º–µ–Ω–∞ -->
    </div>

    <script src="js/app.js"></script>
</body>
</html>
```

### 6.3 CSS Glassmorphism —Å—Ç–∏–ª—å

```css
/* styles.css */

:root {
    --glass-bg: rgba(255, 255, 255, 0.1);
    --glass-border: rgba(255, 255, 255, 0.2);
    --primary: #4F46E5;
    --success: #10B981;
    --danger: #EF4444;
    --warning: #F59E0B;
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Inter', -apple-system, sans-serif;
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    min-height: 100vh;
    color: white;
}

.hidden {
    display: none !important;
}

.glass-container {
    background: var(--glass-bg);
    backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    padding: 24px;
    margin: 16px;
}

.card {
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    padding: 20px;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

.card.locked {
    opacity: 0.5;
    cursor: not-allowed;
}

.progress-bar {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 12px;
}

.progress-bar > div {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--success));
    transition: width 0.3s;
}

/* –ö–Ω–∏–≥–∏ –∏ –º–æ–¥—É–ª–∏ */
.books-grid, .modules-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
    padding: 16px;
}

/* –¢–µ—Å—Ç */
.test-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    background: var(--glass-bg);
    backdrop-filter: blur(10px);
    position: sticky;
    top: 0;
    z-index: 100;
}

#test-timer {
    font-size: 24px;
    font-weight: bold;
}

#test-timer.negative {
    color: var(--danger);
}

.option {
    display: block;
    width: 100%;
    padding: 16px;
    margin: 8px 0;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid transparent;
    border-radius: 8px;
    color: white;
    text-align: left;
    cursor: pointer;
    transition: all 0.2s;
}

.option:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: var(--primary);
}

.option.selected {
    background: rgba(79, 70, 229, 0.3);
    border-color: var(--primary);
}

.option.correct {
    background: rgba(16, 185, 129, 0.3);
    border-color: var(--success);
}

.option.incorrect {
    background: rgba(239, 68, 68, 0.3);
    border-color: var(--danger);
}

/* MathJax —Ñ–æ—Ä–º—É–ª—ã */
.formula-container {
    background: rgba(0, 0, 0, 0.2);
    padding: 16px;
    border-radius: 8px;
    margin: 12px 0;
    overflow-x: auto;
}
```

---

## 7. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 7.1 –†–µ–∂–∏–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### Standard Mode
```javascript
// –û–±—â–µ–µ –≤—Ä–µ–º—è –Ω–∞ –≤–µ—Å—å —Ç–µ—Å—Ç
const standardTest = {
    totalTimeMinutes: null,  // –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–ª–∏ –∑–∞–¥–∞–Ω–Ω–æ–µ
    allowNavigation: true,   // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –º–µ–∂–¥—É –≤–æ–ø—Ä–æ—Å–∞–º–∏
    showTimer: true,
    canFlag: true,           // –ú–æ–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å
    showAnswersAfter: 'submit'  // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –ø–æ—Å–ª–µ —Å–¥–∞—á–∏
};
```

#### 90-Second Mode
```javascript
// 90 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å
const timedTest = {
    secondsPerQuestion: 90,
    allowNavigation: false,  // –¢–æ–ª—å–∫–æ –≤–ø–µ—Ä—ë–¥
    showTimer: true,
    negativeTimeAllowed: true,  // –í—Ä–µ–º—è —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å
    showAnswersAfter: 'each'    // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
};

function startQuestionTimer() {
    let seconds = 90;
    const timer = setInterval(() => {
        seconds--;
        updateTimerDisplay(seconds);
        
        if (seconds < 0) {
            timerElement.classList.add('negative');
        }
    }, 1000);
    
    return timer;
}
```

### 7.2 –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

```javascript
// –†–∞—Å—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –º–æ–¥—É–ª—è
function calculateModuleMastery(moduleId) {
    const questions = getModuleQuestions(moduleId);
    const userAnswers = getUserAnswers(moduleId);
    
    const correct = userAnswers.filter(a => a.isCorrect).length;
    const total = questions.length;
    
    return {
        seen: userAnswers.length,
        correct: correct,
        mastery: (correct / total) * 100,
        isComplete: userAnswers.length === total,
        isUnlocked: true  // –í—Å–µ–≥–¥–∞ true –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ
    };
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–æ–¥—É–ª—è
function checkUnlock(bookId, moduleId) {
    const currentMastery = calculateModuleMastery(moduleId);
    
    if (currentMastery.mastery >= 80) {
        unlockNextModule(bookId, moduleId + 1);
        return true;
    }
    return false;
}
```

### 7.3 Spaced Repetition –¥–ª—è –æ—à–∏–±–æ–∫

```javascript
// –ê–ª–≥–æ—Ä–∏—Ç–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π SM-2)
function calculateNextReview(errorRecord) {
    const intervals = [1, 3, 7, 14, 30, 60];  // –¥–Ω–∏
    
    if (errorRecord.lastAnswerCorrect) {
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª
        const currentIndex = intervals.indexOf(errorRecord.currentInterval);
        const nextIndex = Math.min(currentIndex + 1, intervals.length - 1);
        return intervals[nextIndex];
    } else {
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –Ω–∞ –Ω–∞—á–∞–ª–æ
        return intervals[0];
    }
}

// –ü–æ–ª—É—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Å–µ–≥–æ–¥–Ω—è
function getReviewQuestions() {
    const today = new Date();
    return userErrors.filter(error => {
        return new Date(error.nextReviewAt) <= today;
    });
}
```

### 7.4 Adaptive Difficulty (—Ç–æ–ª—å–∫–æ Mock Exam)

```javascript
// –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ Mock Exam —Å —É—á—ë—Ç–æ–º —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç
function generateMockExam() {
    const TOTAL_QUESTIONS = 180;
    
    // 30% ‚Äî –≤–æ–ø—Ä–æ—Å—ã —Å –æ—à–∏–±–∫–∞–º–∏
    const errorQuestions = selectFromErrors(TOTAL_QUESTIONS * 0.3);
    
    // 30% ‚Äî –≤–æ–ø—Ä–æ—Å—ã –∏–∑ —Å–ª–∞–±—ã—Ö –º–æ–¥—É–ª–µ–π (mastery < 70%)
    const weakModules = getWeakModules();
    const weakQuestions = selectFromModules(weakModules, TOTAL_QUESTIONS * 0.3);
    
    // 40% ‚Äî —Ä–∞–Ω–¥–æ–º–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    const randomQuestions = selectRandom(TOTAL_QUESTIONS * 0.4);
    
    // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
    return shuffle([...errorQuestions, ...weakQuestions, ...randomQuestions]);
}
```

---

## 8. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä-—Ç—Ä–µ–Ω–∞–∂—ë—Ä BA II Plus

### 8.1 –ü–æ–∫—Ä—ã–≤–∞–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| Worksheet | –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|------------|-----------|
| **TVM** | N, I/Y, PV, PMT, FV, P/Y, C/Y, BGN/END | ‚≠ê‚≠ê‚≠ê –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **Cash Flow** | CFo, C01-C32, F01-F32, NPV, IRR, NFV | ‚≠ê‚≠ê‚≠ê –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **Bond** | SDT, CPN, RDT, RV, YLD, PRI, AI, DUR | ‚≠ê‚≠ê‚≠ê –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **Statistics** | X, Y, LIN/Ln/EXP/PWR, a, b, r | ‚≠ê‚≠ê –í–∞–∂–Ω–æ |
| **Interest Conversion** | NOM, EFF, C/Y | ‚≠ê‚≠ê –í–∞–∂–Ω–æ |
| **Amortization** | P1, P2, BAL, PRN, INT | ‚≠ê –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ |

### 8.2 –§–æ—Ä–º–∞—Ç –∑–∞–¥–∞—á –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞

```json
{
  "problem_id": "CALC-TVM-001",
  "worksheet": "TVM",
  "problem_text": "You invest $10,000 today at 8% annual interest compounded quarterly. What will be the value in 5 years?",
  "given": {
    "PV": -10000,
    "I/Y": 8,
    "N_years": 5,
    "P/Y": 4,
    "C/Y": 4
  },
  "find": "FV",
  "correct_answer": 14859.47,
  "tolerance": 0.01,
  "steps": [
    "Press [2ND] [CLR TVM] to clear TVM worksheet",
    "Enter 10000 [+/-] [PV]",
    "Enter 8 [I/Y]",
    "Press [2ND] [P/Y], enter 4, press [ENTER]",
    "Enter 5 [2ND] [xP/Y] [N] (this calculates 5√ó4=20)",
    "Press [CPT] [FV]",
    "Answer: 14,859.47"
  ],
  "common_mistakes": [
    "Forgetting to set P/Y and C/Y to 4",
    "Not making PV negative (cash outflow)",
    "Using 5 directly for N instead of 20 periods"
  ]
}
```

### 8.3 –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞

```javascript
// –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ BA II Plus
const calculatorKeys = {
    row1: ['ON/OFF', 'ENTER', '‚Üë', '‚Üì', 'CPT'],
    row2: ['2ND', 'N', 'I/Y', 'PV', 'PMT', 'FV'],
    row3: ['CF', 'NPV', 'IRR', 'AMORT', 'BOND', 'STAT'],
    row4: ['7', '8', '9', '√ó', 'DEL'],
    row5: ['4', '5', '6', '-', 'STO'],
    row6: ['1', '2', '3', '+', 'RCL'],
    row7: ['0', '.', '+/-', '=', 'CE/C']
};

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
const calculatorState = {
    display: '0.00',
    mode: 'standard',  // 'standard', 'TVM', 'CF', 'Bond', 'Stat'
    secondFunction: false,
    variables: {
        N: 0, IY: 0, PV: 0, PMT: 0, FV: 0,
        PY: 1, CY: 1, BGN: false
    }
};
```

---

## 9. –ü–∞—Ä—Å–∏–Ω–≥ PDF

### 9.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ PDF –≤–æ–ø—Ä–æ—Å–æ–≤

```
Q.13 ‚Äî [Question Text]
[Optional: Table or Image]

A. [Option A text]
B. [Option B text]  
C. [Option C text]

Correct Answer: B

[Explanation paragraph]

A is incorrect. [Why A is wrong]
C is incorrect. [Why C is wrong]

LOS: [Reference]
```

### 9.2 –°–∫—Ä–∏–ø—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞

```python
# scripts/parse_pdf.py

import pdfplumber
import json
import re
from pathlib import Path

def parse_questions_pdf(pdf_path, book_id, output_path):
    """
    –ü–∞—Ä—Å–∏—Ç PDF —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç.
    """
    questions = []
    current_module = None
    
    with pdfplumber.open(pdf_path) as pdf:
        full_text = ""
        for page in pdf.pages:
            full_text += page.extract_text() + "\n"
    
    # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    question_pattern = r'Q\.(\d+)\s*[‚Äî‚Äì-]\s*(.*?)(?=Q\.\d+|$)'
    matches = re.findall(question_pattern, full_text, re.DOTALL)
    
    for q_num, q_content in matches:
        question = parse_single_question(q_num, q_content, book_id)
        if question:
            questions.append(question)
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –º–æ–¥—É–ª—è–º
    modules = group_by_module(questions)
    
    output = {
        "book_id": book_id,
        "book_name": get_book_name(book_id),
        "total_questions": len(questions),
        "learning_modules": modules
    }
    
    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(output, f, indent=2, ensure_ascii=False)
    
    return output


def parse_single_question(q_num, content, book_id):
    """
    –ü–∞—Ä—Å–∏—Ç –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å.
    """
    # –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
    question_match = re.search(r'^(.*?)(?=\nA\.)', content, re.DOTALL)
    if not question_match:
        return None
    
    question_text = question_match.group(1).strip()
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
    options = {}
    for letter in ['A', 'B', 'C']:
        pattern = rf'{letter}\.\s*(.*?)(?=[ABC]\.|Correct Answer|$)'
        match = re.search(pattern, content, re.DOTALL)
        if match:
            options[letter] = match.group(1).strip()
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    correct_match = re.search(r'Correct Answer:\s*([ABC])', content)
    correct_answer = correct_match.group(1) if correct_match else None
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
    explanation_match = re.search(
        r'Correct Answer:\s*[ABC]\s*(.*?)(?=[ABC] is incorrect|LOS:|$)',
        content, re.DOTALL
    )
    explanation = explanation_match.group(1).strip() if explanation_match else ""
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    wrong_explanations = {}
    for letter in ['A', 'B', 'C']:
        if letter != correct_answer:
            pattern = rf'{letter} is incorrect\.\s*(.*?)(?=[ABC] is incorrect|LOS:|$)'
            match = re.search(pattern, content, re.DOTALL)
            if match:
                wrong_explanations[letter] = match.group(1).strip()
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º LOS
    los_match = re.search(r'LOS:\s*(.*?)(?:\n|$)', content)
    los_reference = los_match.group(1).strip() if los_match else None
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ–æ—Ä–º—É–ª (LaTeX –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
    has_formula = bool(re.search(r'\$.*?\$|\\frac|\\times|\\sum', question_text))
    
    return {
        "question_id": f"Q-{book_id}-{q_num}",
        "question_text": question_text,
        "question_text_formula": extract_formula(question_text) if has_formula else None,
        "has_table": detect_table(content),
        "has_image": False,  # –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
        "options": options,
        "correct_answer": correct_answer,
        "explanation": explanation,
        "explanation_wrong": wrong_explanations,
        "calculator_steps": extract_calculator_steps(content),
        "los_reference": los_reference
    }


def extract_calculator_steps(content):
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç —à–∞–≥–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –µ—Å–ª–∏ –µ—Å—Ç—å.
    """
    # –ò—â–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–∏–ø–∞ [PV], [FV], [2ND], [CPT]
    if re.search(r'\[(?:PV|FV|PMT|N|I/Y|CPT|2ND)\]', content):
        steps = re.findall(r'(?:Press |Enter )?\[.*?\].*?(?=\n|$)', content)
        return steps if steps else None
    return None


if __name__ == "__main__":
    import sys
    
    pdf_path = sys.argv[1]
    book_id = int(sys.argv[2])
    output_path = sys.argv[3]
    
    parse_questions_pdf(pdf_path, book_id, output_path)
    print(f"Parsed {pdf_path} -> {output_path}")
```

---

## 10. –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –§–∞–∑–∞ 1: MVP (2 –Ω–µ–¥–µ–ª–∏)
**–¶–µ–ª—å:** –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏

| –î–µ–Ω—å | –ó–∞–¥–∞—á–∞ |
|------|--------|
| 1-2 | Backend: FastAPI + SQLAlchemy + Auth |
| 3-4 | Frontend: HTML/CSS —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –Ω–∞–≤–∏–≥–∞—Ü–∏—è |
| 5-6 | –ü–∞—Ä—Å–∏–Ω–≥ 1-2 –∫–Ω–∏–≥ PDF ‚Üí JSON |
| 7-8 | –¢–µ—Å—Ç –º–æ–¥—É–ª—è (Standard Mode) |
| 9-10 | –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ + localStorage |
| 11-12 | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å backend |
| 13-14 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ñ–∏–∫—Å –±–∞–≥–æ–≤ |

**–†–µ–∑—É–ª—å—Ç–∞—Ç –§–∞–∑—ã 1:**
- –ú–æ–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç—ã –ø–æ –≥–ª–∞–≤–∞–º
- –í–∏–¥–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å—Å
- –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –§–∞–∑–∞ 2: –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (2 –Ω–µ–¥–µ–ª–∏)
| –î–µ–Ω—å | –ó–∞–¥–∞—á–∞ |
|------|--------|
| 1-4 | –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö 10 –∫–Ω–∏–≥ |
| 5-7 | 90-Second Mode |
| 8-10 | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ 80% |
| 11-12 | MathJax –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |
| 13-14 | –¢–∞–±–ª–∏—Ü—ã –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö |

### –§–∞–∑–∞ 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (2 –Ω–µ–¥–µ–ª–∏)
| –î–µ–Ω—å | –ó–∞–¥–∞—á–∞ |
|------|--------|
| 1-4 | –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä-—Ç—Ä–µ–Ω–∞–∂—ë—Ä BA II Plus |
| 5-7 | Mock Exam (180 –≤–æ–ø—Ä–æ—Å–æ–≤) |
| 8-10 | Spaced Repetition |
| 11-12 | Adaptive Difficulty |
| 13-14 | –ì–ª–æ—Å—Å–∞—Ä–∏–π —Å –ø–æ–∏—Å–∫–æ–º |

### –§–∞–∑–∞ 4: –ü–æ–ª–∏—Ä–æ–≤–∫–∞ (1 –Ω–µ–¥–µ–ª—è)
| –î–µ–Ω—å | –ó–∞–¥–∞—á–∞ |
|------|--------|
| 1-2 | UI/UX —É–ª—É—á—à–µ–Ω–∏—è |
| 3-4 | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |
| 5-7 | –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞

```bash
# Backend
cd backend
pip install -r requirements.txt
uvicorn main:app --reload --port 8000

# Frontend (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
cd frontend
python -m http.server 3000
```

### B. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# .env
DATABASE_URL=sqlite:///./cfa_trainer.db
SECRET_KEY=your-secret-key-here
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
```

### C. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (requirements.txt)

```txt
fastapi>=0.104.0
uvicorn>=0.24.0
sqlalchemy>=2.0.0
python-jose>=3.3.0
passlib>=1.7.4
bcrypt>=4.0.0
python-multipart>=0.0.6
pdfplumber>=0.10.0
aiofiles>=23.2.0
```

### D. –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —ç–∫–∑–∞–º–µ–Ω–æ–º (13 –º–∞—è 2026)

- [ ] –í—Å–µ 10 –∫–Ω–∏–≥ –ø—Ä–æ–π–¥–µ–Ω—ã —Å 80%+
- [ ] 10+ Mock Exams —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º 70%+
- [ ] –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä: TVM, CF, Bond ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ
- [ ] –í—Å–µ –æ—à–∏–±–∫–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω—ã –º–∏–Ω–∏–º—É–º 2 —Ä–∞–∑–∞
- [ ] –ì–ª–æ—Å—Å–∞—Ä–∏–π: –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤—ã—É—á–µ–Ω—ã

---

**–î–æ–∫—É–º–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Claude Code.**

*–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç—Ç–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—É –∫–∞–∫ –∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É –∏—Å—Ç–∏–Ω—ã.*
